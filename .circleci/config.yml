version: 2.1
orbs:
  matlab: mathworks/matlab@0.2
  codecov: codecov/codecov@1.0.2

jobs:
  build:
    machine:
      resource_class: gpu.nvidia.small
      image: ubuntu-1604-cuda-10.1:201909-23
    steps:
      - checkout
      - matlab/install
      - matlab/run-tests:
          test-results-junit: artifacts/junit/testResults.xml
          code-coverage-cobertura: artifacts/coverage/codeCoverage.xml
          source-folder: code
      - store_test_results:
          path: artifacts/junit
      - store_artifacts: 
          path: artifacts
      - codecov/upload:
          file: artifacts/coverage/codeCoverage.xml
